import java.util.ArrayList;
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.File;
import java.io.FileInputStream;
import java.util.Scanner; 
import java.nio.charset.*;
import java.lang.Math;
public class Main {

	public static void main(String[] args) {
		
		
	/*	
		//String txtDecoder = "01000010000100001000000000000000000000000000000000001111111111101100100110101011111010100000101111100111111010101101011011101111111000101101000110011010101001111101011111001100101100010001011011001011110110001010101101111101010101111101111111100010101011010000100000000000000000000000000000000000000000000000000000001111101011110000111010001000110101100111000010000110101010010101001010000100000000000000000000000000000000001101001111001011111001111000110010111110111110011111110001110001110010011001111110000001011010101100111111100110101010101001100111111000000111110101011110010011010011001001011110110001000101101000101100110101100100100001000010000100001000000000000000000000000000000000000000000000000000000000000110101111100111111101011000101101000111110101010001100100100001000000000000000000000000000000000000000000000000101011110111000001001001010100101011000101010100110111100111101110101001011000011110011101010100110110100001000010000000111111010100111100111011011001100001001110001000111101011011100111001001010011110010010111110100011100101110100001100101011100000101110100101011101000010110110110011011100111001000111101010101011100100101110000011110010111010010010101110000001000111101000110101011100000100011010100100101010010101100011110100110100111001100110001001001101001011011001101110011100100101001101100101110010010111000001001110110101001011100100101110000101011010001101111010101000110000110101001011101101100110110000001010110000111001110110110010001100101011001001010011011011010000110000101110110110000101101101100111001001101011010010101001010110001111011011101110011000100101011100000010001111010001101010111000000110000100111000100100001011100110110111110010010111000110001000111101111011010001110101000100101001101101100010011101010000110000111001110110101111011000010111000100110110000000111011101010010110010101110000100011001110101110110101001100010011100100100111010100110001000101110010011010010110110011000010010100111010001110100010010101001010110011110110001101100110111001110010011000111101101110111001100110001010100000100010101001011011111010111001001010100011111101010011110011101101100010111001100001110101010010110111110110100001100001110011101101011110110000101110001001101100000001110111010100101100101011100001000110011101011101101010010101000100101000001000000";
		String seq2       = "0100001000010000100000000000000000000000000000000000111111111110110010011010101111101010000010111110011111101010110101101110111111100010110100011001101010100111110101111100110010110001000101101100101111011000101010110111110101010111110111111110001010101101000010000000000000000000000000000000000000000000000000000000111110101111000011101000100011010110011100001000011010101001010100101000010000000000000000000000000000000000110100111100101111100111100011001011111011111001111111000111000111001001100111111000000101101010110011111110011010101010100110011111100000011111010101111001001101001100100101111011000100010110100010110011010110010010000100001000010000100000000000000000000000000000000000000000000000000000000000011010111110011111110101100010110100011111010101000110010010000100000000000000000000000000000000000000000000000010101111011100000100100101010010101100010101010011011110011110111010100101100001111001110101010011011010000100001000000011111101010011110011101101100110000100111000100011110101101110011100100101001111001001011100001010110100011100101110100001100101011100000101110100101011101000010110110110011011100111001000111101010101011100100101110000011110010111010010010101110000001000111101000110101011100000100011010100100101010010101100011110100110100111001100110001001001101001011011001101110011100100101001101100101110010010111000001001110110101001011100100101110000101011010001101111010101000110000110101001011101101100110110000001010110000111001110110110010001100101011001001010011011011010000110000101110110110000101101101100111001001101011010010101001010110001111011011101110011000100101011100000010001111010001101010111000000110000100111000100100001011100110110111110010010111000110001000111101111011010001110101000100101001101101100010011101010000110000111001110110101111011000010111000100110110000000111011101010010110010101110000100011001110101110110101001100010011100100100111010100110001000101110010011010010110110011000010010100111010001110100010010101001010110011110110001101100110111001110010011000111101101110111001100110001010100000100010101001011011111010111001001010100011111101010011110011101101100010111001100001110101010010110111110110100001100001110011101101011110110000101110001001101100000001110111010100101100101011100001000110011101011101101010010101000100101000001000";
		//System.out.println(seq1.length());
		String seq ="10001010";
		String seq3 = "10010001";
		String leress="";
		String leressi="";
		for (int i = 0; i<seq2.length();i++) {
			leressi = leressi + seq2.charAt(i);
			if (leressi.length()==8) {
				leress = leress + leressi + " ";
				leressi = "";
			}
		}
		System.out.println(leress);
		int seqInt = Integer.parseInt(seq,2);
		System.out.println(seqInt);
		int seqInt2 = Integer.parseInt(seq3,2);
		System.out.println(seqInt2);
		char e =(char)seqInt;
		char e1 = (char)seqInt2;
		char e2 = (char) 145;
		char e3 = (char)138;
		
		/// ce char tu l'ecrit dans le fichier 
		System.out.println(e);
		System.out.println(e1);
		System.out.println(e2);
		System.out.println(e3);
		System.out.println(e==e1);
		System.out.println(e2==e3);
		System.out.println((int)e3);
		System.out.println("un res" +Integer.toBinaryString(e));
		
		

		System.out.println("   :    " +Integer.toBinaryString(e));
		//int res = e;
		//System.out.println(res);
		String res2 = Integer.toBinaryString(e);
		//1System.out.println(("res2")+ res2);
		if (res2.length()<8) {
			String res3=res2;
			while (res3.length()<8) {
				res3 = "0" + res3;
			}
			System.out.println(res3);
		}
		
		
		
		//int v = Character.getNumericValue(e);
		//System.out.println("le v"+ v);
		//String leRes = Integer.toString(v);
		//System.out.println(leRes);
		
	//	System.out.println(decimal);
		//System.out.println(hexStr);
		//System.out.println(seq.getBytes());
		int seq_size = seq.length() ; 
		System.out.println(seq_size);
        int taille_seq_voulu = 8;
        String show = "";
         int w=0;
        int j = 8;
        
    String codeAvantencod = "001010001010001010001010101010101010101010101010101010100011011000110101110101110011011101000101110111101111001101001010001101101101001010011011111101011101100010100010011011100001010010111010010001011101100110100101001011100000101000110000101001100010100000001010001110100101010111011110100100001101011100110110000101000111010010100101000101010101010101010101010101010101010101010101010101010100011010111000000110000011001001011011101001100001110011101110101001010001010001010101010101010101010101010101010001101110010111010001011101110000101001000101110000110101110011010111010111011000101000100010100010101110000010100101000101001001011010001011000101001010011010111110111010011010010000010100101000101001001001011101111010010101011100001101110010111000001010000000101000110110111010100111010000110111010100000101000101000101000101000101010101010101010101010101010101010101010101010101010101010110111010001011101000011011011011101011001101110010111011110100100100101110000101000101010101010101010101010101010101010101010101010110100101011100110011111001001110000010110100100110000010010001001000110100001101000010111010001110101000000010100010100010101010001101100101000011110101000010001100110000100100001001000001011000011111111110001111110101101001000111100101100000010010000101010000001111101101001000001100111000001100100111011010100010000011010001000001111110101101000010011101101011100000001111000100000110010001000000001110010100111111110010011100000100001001110011110101111011011101100111101100100111011010101";;
    String codeAprescode =  "001010001010001010001010101010101010101010101010101010100011011000110101110101110011011101000101110111101111001101001010001101101101001010011011111101011101100010100010011011100001010010111010010001011101100110100101001011100011000010100110001010000011101001010101110111101001000011010111001101100001010001110100101001010001010101010101010101010101010101010101010101010101010101000110101110000001100000110010010110111010011000011100111011101010010100010100010101010101010101010101010101010100011011100101110100010111011101000101110000110101110011010111010111011000101000100010100010101110000010100101000101001001011010001011000101001010011010111110111010011010010000010100101000101001001001011101111010010101011111001011100000101000000010100011011011101010011101000011011101010000010100010100010100010100010101010101010101010101010101010101010101010101010101010101011011101000101110100001101101101110101100110111001011101111010010010010111000010100010101010101010101010101010101010101010101010101011010010101110011001111100100111000001011010010011000001001000100100011010000110100001011101000111010100000001010001010001010101000110110010100001111010100001000110011000010010000100100000101100001111111111000111111010110100100011110010110000001001000010101000000111110110100100000110011100000110010011101101010001000010000011111101011010000100111011010111000000011110001000001100100010000000011100101001111111100100111000001000010011100111101011110110111011001111011001001110110101011101100000101010001111110101101011110111";
    String avant = 	        "001010001010001010001010101010101010101010101010101010100011011000110101110101110011011101000101110111101111001101001010001101101101001010011011111101011101100010100010011011100001010010111010010001011101100110100101001011100000101000110000101001100010100000001010001110100101010111011110100100001101011100110110000101000111010010100101000101010101010101010101010101010101010101010101010101010100011010111000000110000011001001011011101001100001110011101110101001010001010001010101010101010101010101010101010001101110010111010001011101110000101001000101110000110101110011010111010111011000101000100010100010101110000010100101000101001001011010001011000101001010011010111110111010011010010000010100101000101001001001011101111010010101011100001101110010111000001010000000101000110110111010100111010000110111010100000101000101000101000101000101010101010101010101010101010101010101010101010101010101010110111010001011101000011011011011101011001101110010111011110100100100101110000101000101010101010101010101010101010101010101010101010110100101011100110011111001001110000010110100100110000010010001001000110100001101000010111010001110101000000010100010100010101010001101100101000011110101000010001100110000100100001001000001011000011111111110001111110101101001000111100101100000010010000101010000001111101101001000001100111000001100100111011010100010000011010001000001111110101101000010011101101011100000001111000100000110010001000000001110010100111111110010011100000100001001110011110101111011011101100111101100100111011010101";
    String codeApres =      "001010001010001010001010101010101010101010101010101010100011011000110101110101110011011101000101110111101111001101001010001101101101001010011011111101011101100010100010011011100001010010111010010001011101100110100101001011100011000010100110001010000011101001010101110111101001000011010111001101100001010001110100101001010001010101010101010101010101010101010101010101010101010101000110101110000001100000110010010110111010011000011100111011101010010100010100010101010101010101010101010101010100011011100101110100010111011101000101110000110101110011010111010111011000101000100010100010101110000010100101000101001001011010001011000101001010011010111110111010011010010000010100101000101001001001011101111010010101011111001011100000101000000010100011011011101010011101000011011101010000010100010100010100010100010101010101010101010101010101010101010101010101010101010101011011101000101110100001101101101110101100110111001011101111010010010010111000010100010101010101010101010101010101010101010101010101011010010101110011001111100100111000001011010010011000001001000100100011010000110100001011101000111010100000001010001010001010101000110110010100001111010100001000110011000010010000100100000101100001111111111000111111010110100100011110010110000001001000010101000000111110110100100000110011100000110010011101101010001000010000011111101011010000100111011010111000000011110001000001100100010000000011100101001111111100100111000001000010011100111101011110110111011001111011001001110110101011101100000101010001111110101101011110111";
    //String uncode =         "00101000101000101000101010101010101010101010101010101010001101100011010111010111001101110100010111011110111100110100101000110110110100101001101111110101110110001010001001101110000101001011101001000101110110011010010100101110";
    //System.out.println("taille" + uncode.length() );
    System.out.println("avant" + codeAvantencod.length());
    System.out.println("apres" + codeAprescode.length());
    System.out.println(codeAprescode.equals(codeApres));
    Unzip uzp1 = new Unzip("extrait_alice_compressed.txt");
    
   System.out.println("ouloulou");
       String res = uzp1.unzipToString();
      System.out.println("le res est " +res.substring(0,1521));*/
		
		
	/*	LectureData reader = new LectureData("example_Freq.dat");
		ArrayList<String[]> liste = reader.arrayListValue();
		
		for (int i =0; i< liste.size();i++){
			
		    	  System.out.println("la lettre " + liste.get(i)[0] + " / la freq : "+ liste.get(i)[1]);
		      
		}*/
        
        /*show = seq.substring(w, j);
        System.out.println(show);
        w+=2;
        j+=2;
        show = seq.substring(w, j);
        System.out.println(show);
        System.out.println(seq);*/
	 /*   for (int i = 0; i< ((seq_size/taille_seq_voulu) + 1); i++) 
	    { 
	    	System.out.println("w " + w);
	    	System.out.println("j "+ j);
	    	/*show = show + seq.charAt(i);
	        if(show.length()==8) { 
	             
	        System.out.print(show); 
	        System.out.println(); 
	        
	        }
	        else {
	        	if 
	        }
	    	if (j >seq.length()){
	    		show = seq.substring(w,seq.length());
	    	}
	    	else {
	    	show = seq.substring(w, j);
	    	}
	    	w+=8;
	    	j+=8;
	    	
	    	
	    	System.out.println(show);
	    	show = "";
	    }
	    
		
		// TODO Auto-generated method stub
		// The name of the file to open.
	/*
        
        LectureData reader = new LectureData("freq.dat");
        ArrayList<String[]> dataList = reader.arrayListValue();
        
        // lis le fichier txt et retourne un tableau de tableau aves les freq
        LectureData reader2 = new LectureData("example.txt");
        ArrayList<String[]> test =reader2.dicoText();
        
     // Creation des feuilles
        // creation des feuilles suivants les lignes de tableau         
        ArrayList<Noeud> nodeList = new ArrayList<Noeud>();
        for (int i =0; i< test.size();i++) {
        	
        	Noeud leNode = new Noeud(test.get(i)[0],Integer.parseInt( test.get(i)[1]));
        	nodeList.add(leNode);	
        }
        
        /* ------------- Tests ---------------------------
        System.out.println(nodeList.size());
        for (int i =0; i<nodeList.size();i++) {
        	System.out.println(nodeList.get(i).getLettre());
        	System.out.println(nodeList.get(i).getVal());
        }
        
  /*      ArrayList<Noeud> nodeListExec = new ArrayList<Noeud>();
        // copie les même noeud et pas une copie de noeud 
        
        */
/*       ArrayList<Noeud> nodeListExec = new ArrayList<Noeud>();
       
      /* for (int j = 0 ; j<nodeList.size();j++) {
         	nodeListExec.add(nodeList.get(j).clone());
         }*/
      
   /*    HuffmanForest hF = new HuffmanForest(nodeListExec);
       
      /* while (hF.getForet().size()>1){
          	hF.remakeForest();
          System.out.println(hF.getForet().size());
          }
       System.out.println( hF.getForet().get(0).deepPath("", "n"));
       
       
       */
   /*    String newFile = "freq1.dat";
       LectureData newDat = new LectureData(newFile);
       
      // marche sauf pour E 
       //pour tous les elements du tableau de freq, on crée un arbre et on retourne son code de Huffman
       
       for (int i = 0; i<test.size();i++) {
    	   
    	   nodeListExec.clear();
    	   for (int j = 0 ; j<nodeList.size();j++) {
           	nodeListExec.add(nodeList.get(j).clone());
           }
    	   
    	   hF = new HuffmanForest(nodeListExec);
           while (hF.getForet().size()>1){
           	hF.remakeForest();
          // System.out.println(hF.getForet().size());
           }
           
          // ecrit dans le fichier le codage de huffman 
          // System.out.println(test.get(i)[0] + " : "+  hF.getForet().get(0).deepPath("", test.get(i)[0]));
           newDat.writeInFile(test.get(i)[0], hF.getForet().get(0).deepPath("", test.get(i)[0]));
    	   
    	   
       }
       
       LectureData reader1 = new LectureData("freq1.dat");
       ArrayList<String[]> dataList2 = reader1.arrayListValue2();
       
       for (int i = 0; i< dataList2.size();i++) {
    	   System.out.println(dataList2.get(i)[0]+ " : " + dataList2.get(i)[1]);
       }
       File f = new File("example.txt");
       Codage c = new Codage("res");
       c.code(f, dataList2);
       
       
       
       
       /*LectureData reader2 = new LectureData("example.txt");
       ArrayList<String[]> test =reader2.dicoText();
       System.out.println(test.size());
       
       for (int i =0; i < test.size();i++) {
    	   System.out.println(test.get(i)[0]+" : " + test.get(i)[1]);
    	   
       }
  	*/	
	//	byte data = 0b01010101;
		//System.out.println(data);
		//System.out.println((char)data);
		
		
		
	/*	CodageHuffman e = new CodageHuffman("example","example_Freq.dat");
		e.leCodageStatique();*/
		LectureData l = new LectureData("example_Freq.dat");
		ArrayList<String[]> p = l.arrayListValue();
		for (int i =0; i< p.size();i++) {
			 System.out.println("la lettre " + p.get(i)[0] + " / la freq : "+ p.get(i)[1]);
		}
        	


		Scanner sc = new Scanner(System.in);
		System.out.println("Veuillez selectionner un mode :");
		System.out.println("1 -Mode Statique");
		System.out.println("2 - Mode semi-statique");
		int choix = sc.nextInt();
		sc.nextLine();
		switch (choix) {
		case 2 : 
			System.out.println("Vous avez choisi le mode semi-statique");
			System.out.println("Veuillez selectionner une option :");
			System.out.println("1 - Coder un fichier .txt. ");
			System.out.println("2 - Decoder un fichier .dat");
			System.out.print("Votre choix : ");
			int choix2 = sc.nextInt();
			sc.nextLine();
			
			switch (choix2) {
			
			case 1 :
				
				System.out.println("Vous avez choisit de coder un fichier .txt");
				System.out.println("Veuillez rentrer le nom du fichier, sans l'extention .txt");
				System.out.println("Veillez à qu'il soit bien dans le repertoire du projet");
				System.out.println("Nom du fichier:");
				String name = sc.nextLine();
				System.out.println(name);
				CodageHuffman c = new CodageHuffman(name);
				c.leCodage();
				sc.close();
				break;
			case 2 : 
				System.out.println("Vous avez choisit de decoder un fichier .dat utilisant le codage de Huffman ");
				System.out.println("Veuillez rentrer le préfixe du fichier, cad la chaine de caractère avant le '_'");
				System.out.println("Example avec le fichier example_huffCode.dat --> Veuillez rentrer : example");
				String name1 = sc.nextLine();
				Unzip uzp = new Unzip(name1+"_compressed.txt");
				System.out.println("le code du texte en 0 et 1" +uzp.unzipToString());
				System.out.println("compressedText est passer ");
				DecodageHuffman d = new DecodageHuffman(name1+"_dico.dat",uzp.unzipToString());
				d.decode();
				sc.close();
				
				break;
			default :
				System.out.println("veuiller choisir entre 1 et 2 ");
				break;
		
				
			}
			break;
		case 1 :
			System.out.println("Vous avez choisi le mode Statique");
			System.out.println("Veuillez selectionner une option :");
			System.out.println("1 - Coder un fichier .txt à l'aide d'un fichier _Freq.dat");
			System.out.println("2 - Decoder un fichier .dat");
			System.out.print("Votre choix : ");
			int choix3 = sc.nextInt();
			sc.nextLine();
			switch (choix3) {
			case 1 :
				System.out.println("Vous avez choisit de coder un fichier .txt");
				System.out.println("Veuillez rentrer le nom du fichier, sans l'extention .txt");
				System.out.println("Veillez à qu'il soit bien dans le repertoire du projet ");
				System.out.println("Nom du fichier:");
				String name = sc.nextLine();
				System.out.println(name);
				
				
				CodageHuffman c = new CodageHuffman(name,name+"_Freq.dat");
				c.leCodageStatique();
				sc.close();
				break;
			case 2 : 
				System.out.println("Not implemented");
				sc.close();
			}
	
			
		}
		
		//CodageHuffman c = new CodageHuffman("alice29");, 
		//c.leCodage();
		
		//System.out.println(a.contains({"a",.}));
//		DecodageHuffman d = new DecodageHuffman("alice29_dico.dat","alice29_huffCode.dat");
	//	d.decode();
		
	/*	try {
			BufferedReader br = new BufferedReader(new FileReader("example_dico.dat"));
			
			System.out.println(br.readLine().equals(""));
			System.out.println(br.readLine());
			br.close();
		}catch (Exception e){
			System.out.println(e.toString());
			}*/
		
		
	}
}